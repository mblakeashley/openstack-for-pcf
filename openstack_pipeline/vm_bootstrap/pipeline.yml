---
resources:
- name: vm_bootstrap
  type: git
  source:
    branch: dev_branch
    uri: https://github.com/pivotal-gss/openstack-for-pcf.git

jobs:
- name: gss-lab28-vm-bootstrap
  public: true
  plan:
  - get: vm_bootstrap
  - task: vm_bootstrap
    file: vm_bootstrap/openstack_pipeline/vm_bootstrap/vm_bootstrap.yml
    params:
       USERNAME: {{vc-28-username}}
       PASSWORD: {{vc-28-password}}

- name: gss-lab28-packstack-deploy
  plan:
  - get: vm_bootstrap
    passed: [gss-lab28-vm-bootstrap]
    trigger: true
  - task: vm_packstack_deploy
    config:
      platform: linux
      image_resource:
        type: docker-image
        source: {repository: centos, tag: "centos6"}
      inputs:
        - name: vm_bootstrap
      run:
        path: ./vm_bootstrap/openstack_pipeline/vm_bootstrap/vm_packstack.sh
